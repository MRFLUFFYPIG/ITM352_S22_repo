<!-- Nicholas Sebastian -->
<!-- Login Page for the site -->

<script>

    var params = (new URL(document.location)).searchParams; 
    var login_action = "login.html";
    //Keeps the quantities around for login only .
    login_action += params; 

    //Keeps the quantities around for register only.
    var registration_action = "register.html";
    registration_action += params; 
</script>

<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Log In Page</title>
</head>

<body>
    <div class=container>
        <div class=login_card>
                <div class=header>Log In</div>
                <script> //Post the form to itself so that I can keep the quantities in the query
                    document.write(`<form name="login_fields" action=${login_action} method="POST">
                    <input type="text" name="username" size="40" placeholder="Username" ><br>`)
                </script>
                <script>
                    //Selecting which error message to display depending on the error received from server-side
                    //If username doesn't match 
                    if (params.get("attempted_login") == "true" && params.get("login_username_check") == "does_not_exist") { 
                        document.write(`<div class="invalid_username"> Please enter a valid username </div>`)
                    } else {
                        document.write(`<br>`)
                    }
                </script>
                <input type="password" name="password" size="40" placeholder="Password"><br>
                <script>
                    //If the password doesn't match 
                    if (params.get("login_password") == "incorrect") { 
                        document.write(`<div class="invalid_password"> Incorrect Password </div>`)
                    }
                </script>
    
                <input type="submit" value="Log In" id="submit">

                </form>
            <div class=no_account>
                New user?
                <script>
                    //Link to go registration page if they have no account already.
                    document.write(`<a href=${registration_action}>Register</a>`) 
                </script>
            </div>
        </div>

</body>

<script>

    //Makes username login field sticky. Not the password though for security reasons.
    var entered_username = params.get("login_username");

    if (params.get("attempted_login") == "true") {
        login_fields["username"].value = entered_username; //making username sticky
    };
    if (params.get("login") == "no_login_entered") {
        alert("Please enter your username.") //if there is no username inputted, then it sends an alert.
    }
    if (params.get("registration_successful") == "true") { //This pops up after the registration. It just made more sense to me to have the customer test out the account after they register.
        alert("Registration successful! Please log in to continue.")
    }

</script>
    <br>
    <!-- Button that allows the user to go back to the products page -->
    <input type="button" class="button" value="Back To Store" onclick="window.location.href = 'index.html';">
    <br>
</html>